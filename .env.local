# OBP Keycloak Provider - Local PostgreSQL Configuration
# This configuration uses existing local PostgreSQL instances instead of Docker containers
#
# Database Setup:
# - Keycloak DB: localhost:5432/keycloakdb (user: keycloak, password: f)
# - User Storage DB: localhost:5432/obp_mapped (user: obp, password: f)
#
# Usage:
# 1. Copy this file: cp .env.local .env
# 2. Run: ./sh/run-local-postgres.sh
# 3. Access: http://localhost:8080 or https://localhost:8443

# =============================================================================
# KEYCLOAK ADMIN CONFIGURATION
# =============================================================================
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=admin

# =============================================================================
# KEYCLOAK'S INTERNAL DATABASE CONFIGURATION (Local PostgreSQL)
# =============================================================================
KC_DB=postgres
KC_DB_URL=jdbc:postgresql://localhost:5432/keycloakdb
KC_DB_USERNAME=keycloak
KC_DB_PASSWORD=f

# =============================================================================
# USER STORAGE DATABASE CONFIGURATION (Local PostgreSQL)
# =============================================================================
DB_URL=jdbc:postgresql://localhost:5432/obp_mapped
DB_USER=obp
DB_PASSWORD=f
DB_DRIVER=org.postgresql.Driver
DB_DIALECT=org.hibernate.dialect.PostgreSQLDialect

# =============================================================================
# HIBERNATE CONFIGURATION (for User Storage)
# =============================================================================
HIBERNATE_DDL_AUTO=validate
HIBERNATE_SHOW_SQL=true
HIBERNATE_FORMAT_SQL=true

# =============================================================================
# KEYCLOAK RUNTIME CONFIGURATION
# =============================================================================
KC_HOSTNAME_STRICT=false
KC_HOSTNAME_STRICT_HTTPS=false
KC_HTTP_ENABLED=true
KC_HEALTH_ENABLED=true
KC_METRICS_ENABLED=true
KC_FEATURES=token-exchange

# =============================================================================
# NETWORK PORTS (for standalone Keycloak container)
# =============================================================================
KEYCLOAK_HTTP_PORT=8080
KEYCLOAK_HTTPS_PORT=8443

# =============================================================================
# LOCAL DEVELOPMENT NOTES
# =============================================================================
# This configuration assumes:
# 1. PostgreSQL is running locally on port 5432
# 2. Database 'keycloakdb' exists with user 'keycloak' (password: 'f')
# 3. Database 'obp_mapped' exists with user 'obp' (password: 'f')
# 4. Both users have appropriate permissions on their respective databases
#
# Database Connection Test Commands:
# psql -h localhost -p 5432 -U keycloak -d keycloakdb
# psql -h localhost -p 5432 -U obp -d obp_mapped
#
# Required Schema:
# The obp_mapped database should contain the 'authuser' table for user federation
